<eb-container>
  <ng-container *transloco="let t">
    <eb-stack spacing="lg">
      <header class="modules__header">
        <h1 class="modules__title">{{ t('modules.title') }}</h1>
        <p class="modules__subtitle">{{ t('modules.subtitle') }}</p>
      </header>

      <!-- Search Section -->
      <div class="modules__search">
        <eb-input
          [value]="searchValue()"
          (valueChange)="onSearchChange($event)"
          [placeholder]="t('modules.searchPlaceholder')"
          [ariaLabel]="t('modules.searchLabel')"
          type="search"
          inputId="module-search"
        >
        </eb-input>
        @if (store.filter()) {
          <span class="modules__search-count">
            {{ t('modules.resultsCount', { count: store.filteredModules().length }) }}
          </span>
        }
      </div>

      <!-- Loading State -->
      @if (store.isLoading()) {
        <div class="modules__loading">
          {{ t('common.loading') }}
        </div>
      }

      <!-- Error State -->
      @if (store.error()) {
        <div class="modules__error">
          {{ store.error() }}
        </div>
      }

      <!-- Modules Grid -->
      @if (!store.isLoading() && !store.error()) {
        @if (store.filteredModules().length > 0) {
          <eb-grid [cols]="1" [colsMd]="2" [colsLg]="3" gap="lg">
            @for (module of store.filteredModules(); track module.id) {
              <a [routerLink]="['/modules', module.id]" class="module-card-link">
                <eb-card class="module-card" [hoverable]="true">
                  <eb-stack card-body spacing="sm">
                    <div class="module-card__header">
                      <eb-badge
                        [variant]="getStatusVariant(module.status)"
                        [content]="t('modules.statuses.' + module.status)"
                        [ariaLabel]="
                          t('modules.detail.statusLabel', {
                            status: t('modules.statuses.' + module.status),
                          })
                        "
                        position="inline"
                      ></eb-badge>
                    </div>
                    <h2 class="module-card__title">
                      {{ t('modules.data.' + module.id + '.title') }}
                    </h2>
                    <p class="module-card__description">
                      {{ t('modules.data.' + module.id + '.description') }}
                    </p>
                    <div class="module-card__footer">
                      <div class="module-card__tags">
                        @for (tag of module.tags; track tag) {
                          <eb-badge
                            [content]="tag"
                            size="sm"
                            variant="secondary"
                            [ariaLabel]="tag"
                            position="inline"
                          ></eb-badge>
                        }
                      </div>
                      <eb-icon [name]="ICONS.CHEVRON_RIGHT" size="sm" [decorative]="true"></eb-icon>
                    </div>
                  </eb-stack>
                </eb-card>
              </a>
            }
          </eb-grid>
        } @else {
          <div class="modules__empty">
            <eb-icon
              [name]="ICONS.SEARCH"
              size="xl"
              class="modules__empty-icon"
              [decorative]="true"
            ></eb-icon>
            <h2 class="modules__empty-title">{{ t('modules.noResults') }}</h2>
            <p class="modules__empty-text">{{ t('modules.noResultsHint') }}</p>
            @if (store.filter()) {
              <eb-button
                variant="secondary"
                [ariaLabel]="t('modules.clearSearch')"
                (click)="clearSearch()"
              >
                {{ t('modules.clearSearch') }}
              </eb-button>
            }
          </div>
        }
      }
    </eb-stack>
  </ng-container>
</eb-container>
